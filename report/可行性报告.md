# 可行性报告
*** 
待补充：  
- [ ] 模糊搜索 （感觉差不多了））））
- [ ] 概要设计（已经写完，已由VSCode插件Auto Markdown TOC更新目录）  
  
<!-- TOC -->

- [可行性报告](#%e5%8f%af%e8%a1%8c%e6%80%a7%e6%8a%a5%e5%91%8a)
  - [小组成员](#%e5%b0%8f%e7%bb%84%e6%88%90%e5%91%98)
  - [理论依据](#%e7%90%86%e8%ae%ba%e4%be%9d%e6%8d%ae)
    - [文件系统](#%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f)
      - [DBFS](#dbfs)
    - [API](#api)
    - [图数据库](#%e5%9b%be%e6%95%b0%e6%8d%ae%e5%ba%93)
      - [存储机制](#%e5%ad%98%e5%82%a8%e6%9c%ba%e5%88%b6)
  - [技术依据](#%e6%8a%80%e6%9c%af%e4%be%9d%e6%8d%ae)
    - [Neo4j](#neo4j)
      - [存储结构](#%e5%ad%98%e5%82%a8%e7%bb%93%e6%9e%84)
        - [顶点结构](#%e9%a1%b6%e7%82%b9%e7%bb%93%e6%9e%84)
        - [边结构](#%e8%be%b9%e7%bb%93%e6%9e%84)
        - [属性结构](#%e5%b1%9e%e6%80%a7%e7%bb%93%e6%9e%84)
      - [算法](#%e7%ae%97%e6%b3%95)
          - [中心性算法（Centrality algorithms）](#%e4%b8%ad%e5%bf%83%e6%80%a7%e7%ae%97%e6%b3%95centrality-algorithms)
          - [社区发现算法（Community detection algorithms）](#%e7%a4%be%e5%8c%ba%e5%8f%91%e7%8e%b0%e7%ae%97%e6%b3%95community-detection-algorithms)
          - [路径寻找算法（Path Finding algorithms）](#%e8%b7%af%e5%be%84%e5%af%bb%e6%89%be%e7%ae%97%e6%b3%95path-finding-algorithms)
          - [相似度算法（Similarity algorithms）](#%e7%9b%b8%e4%bc%bc%e5%ba%a6%e7%ae%97%e6%b3%95similarity-algorithms)
          - [链接预测算法（Link Prediction algorithms）](#%e9%93%be%e6%8e%a5%e9%a2%84%e6%b5%8b%e7%ae%97%e6%b3%95link-prediction-algorithms)
    - [文件的自然属性](#%e6%96%87%e4%bb%b6%e7%9a%84%e8%87%aa%e7%84%b6%e5%b1%9e%e6%80%a7)
      - [文档](#%e6%96%87%e6%a1%a3)
          - [讯飞开放平台](#%e8%ae%af%e9%a3%9e%e5%bc%80%e6%94%be%e5%b9%b3%e5%8f%b0)
          - [ParallelDots](#paralleldots)
          - [LinguaKit](#linguakit)
          - [cortical.io](#corticalio)
          - [doc2vec](#doc2vec)
      - [音频](#%e9%9f%b3%e9%a2%91)
          - [讯飞开放平台](#%e8%ae%af%e9%a3%9e%e5%bc%80%e6%94%be%e5%b9%b3%e5%8f%b0-1)
          - [音乐播放器的音乐识别](#%e9%9f%b3%e4%b9%90%e6%92%ad%e6%94%be%e5%99%a8%e7%9a%84%e9%9f%b3%e4%b9%90%e8%af%86%e5%88%ab)
          - [翻译软件的语音转写](#%e7%bf%bb%e8%af%91%e8%bd%af%e4%bb%b6%e7%9a%84%e8%af%ad%e9%9f%b3%e8%bd%ac%e5%86%99)
      - [图像与视频](#%e5%9b%be%e5%83%8f%e4%b8%8e%e8%a7%86%e9%a2%91)
        - [图像](#%e5%9b%be%e5%83%8f)
          - [Clarifai](#clarifai)
          - [Waston Recognition(IBM)](#waston-recognitionibm)
          - [Imagga](#imagga)
          - [百度识图](#%e7%99%be%e5%ba%a6%e8%af%86%e5%9b%be)
          - [whatanime](#whatanime)
        - [视频关键帧提取](#%e8%a7%86%e9%a2%91%e5%85%b3%e9%94%ae%e5%b8%a7%e6%8f%90%e5%8f%96)
          - [FFmpeg](#ffmpeg)
    - [模糊搜索](#%e6%a8%a1%e7%b3%8a%e6%90%9c%e7%b4%a2)
      - [word2vec](#word2vec)
      - [Approximate String Matching](#approximate-string-matching)
      - [FuzzyWuzzy-模糊字符串匹配工具](#fuzzywuzzy-%e6%a8%a1%e7%b3%8a%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%8c%b9%e9%85%8d%e5%b7%a5%e5%85%b7)
  - [创新点](#%e5%88%9b%e6%96%b0%e7%82%b9)
    - [文件系统的智能化](#%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%e7%9a%84%e6%99%ba%e8%83%bd%e5%8c%96)
    - [发掘利用文件的自然属性](#%e5%8f%91%e6%8e%98%e5%88%a9%e7%94%a8%e6%96%87%e4%bb%b6%e7%9a%84%e8%87%aa%e7%84%b6%e5%b1%9e%e6%80%a7)
    - [图数据库与DBFS相结合](#%e5%9b%be%e6%95%b0%e6%8d%ae%e5%ba%93%e4%b8%8edbfs%e7%9b%b8%e7%bb%93%e5%90%88)
    - [高可扩展性](#%e9%ab%98%e5%8f%af%e6%89%a9%e5%b1%95%e6%80%a7)
  - [概要设计](#%e6%a6%82%e8%a6%81%e8%ae%be%e8%ae%a1)
    - [文件储存](#%e6%96%87%e4%bb%b6%e5%82%a8%e5%ad%98)
    - [自然属性提取](#%e8%87%aa%e7%84%b6%e5%b1%9e%e6%80%a7%e6%8f%90%e5%8f%96)
    - [文件搜索](#%e6%96%87%e4%bb%b6%e6%90%9c%e7%b4%a2)
    - [初步目标](#%e5%88%9d%e6%ad%a5%e7%9b%ae%e6%a0%87)
    - [进阶目标](#%e8%bf%9b%e9%98%b6%e7%9b%ae%e6%a0%87)
  - [参考文献](#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae)

<!-- /TOC -->

## 小组成员
- 高楚晴（组长）
- 王幸美
- 王章瀚
- 万嘉诚
- 黄志远

## 理论依据

### 文件系统
文件系统提供在存储介质上组织数据的一种方式方法。其功能包括：管理和调度文件的存储空间，提供文件的逻辑结构、物理结构和存储方法;实现文件从标识到实际地址的映射，实现文件的控制操作和存取操作，实现文件信息的共享并提供可靠的文件保密和保护措施，提供文件的安全措施。

#### DBFS
DBFS是一种新类型文件系统，最早由Onne Gorter在他的硕士论文中开发，现在是一个sf.net项目。事实上，与其称DBFS为文件系统，不如称它为文档系统。它的设计焦点集中于用户，目标是，使得用户的文件管理更加轻松。它将查找文件的责任放在了计算机上，而用户不必记忆文件储存的位置。然后DBFS实际上并不存储文件，而是在基于基础层次结构的文件系统上保存对文件的引用。 GUI部分在KDE中实现，在其中替换了所有基于层次结构的文件访问。这给人的印象是没有层次结构，但是对于应用程序而言，什么都没有改变，打开文件和保存文件对话框具有相同的API。  

### API
API（Application Programming Interface，应用程序接口）是一些预先定义的函数，或指软件系统不同组成部分衔接的约定。目的是提供应用程序与开发人员基于某软件或硬件得以访问一组例程的能力，而又无需访问原码，或理解内部工作机制的细节。

### 图数据库

图数据库类似于1970年代的网络模型数据库，两者都代表通用图，但是网络模型数据库的抽象级别较低，并且缺乏在边缘链上的轻松遍历。

使用图结构进行语义查询的数据库，其中语义节点，边和属性用于表示和存储数据。系统的关键概念是图形（或边或关系）。该图将存储中的数据项与节点和边的集合相关联，边代表节点之间的关系。这些关系允许将存储中的数据直接链接在一起，并且在许多情况下，可以通过一项操作来检索它们。图形数据库将数据之间的关系作为优先级。在图形数据库中查询关系的速度很快，因为它们永久存储在数据库本身中。关系可以使用图形数据库直观地可视化，从而使其对于高度互连的数据很有用。

#### 存储机制

有些依赖关系引擎，并将图形数据“存储”在表中（尽管表是逻辑元素，因此此方法在图形数据库，图形数据库管理系统和数据所在的物理设备之间强加了另一个抽象层次实际存储）。

其他人则使用键值存储或面向文档的数据库进行存储，从而使其固有地具有NoSQL结构。大多数基于非关系存储引擎的图形数据库还添加了标签或属性的概念，这些标签或属性本质上是具有指向另一个文档的指针的关系。这允许对数据元素进行分类，以方便整体检索。

从图形数据库检索数据需要使用SQL以外的查询语言，而SQL是为关系系统中的数据处理而设计的，因此无法“优雅地”处理遍历图形。截至2017年，还没有像SQL关系数据库那样普遍采用单一图查询语言，并且存在各种各样的系统，大多数情况下都与一种产品紧密相关。已经进行了一些标准化工作，从而导致了诸如Gremlin，SPARQL和Cypher的多供应商查询语言。除了具有查询语言接口之外，还可以通过应用程序编程接口（API）访问某些图形数据库。

## 技术依据

### Neo4j
Neo4j是一个高性能的NOSQL图形数据库，它将结构化数据存储在图上而不是表中。它是一个嵌入式的、基于磁盘的、具备完全的事务特性的Java持久化高性能引擎，该引擎具有成熟数据库的所有特性。我们计划使用neo4j完成图数据库的搭建

#### 存储结构

Node和Relationship 的 Property 是用一个 Key-Value 的双向列表来保存的； Node 的 Relatsionship 是用一个双向列表来保存的，通过关系，可以方便的找到关系的 from-to Node.  Node 节点保存第1个 Property和第1个Relationship。

<div align=center>
      <img src="https://github.com/OSH-2020/x-code-nowww/raw/master/image/node.png" width = "270" />
</div>     

##### 顶点结构
1byte：in-use flag  
4byte：第一个 relation id    
4byte：第一个 property id  
5byte：label 信息（可能直接 inline 存储）   
1byte：reversed  

<div align=center>
      <img src="https://github.com/OSH-2020/x-code-nowww/raw/master/image/edge.png" width = "630" />
</div>      
      
##### 边结构  
1byte: in-use flag    
8byte: 该关系的起终点  
4byte: 该关系的类型  
8byte: 该关系起点前后的关系  
8byte: 该关系终点前后的关系  
4byte: 第一个property id  
1byte: 是否为起终点的第一个关系   
<div align=center>
      <img src="https://github.com/OSH-2020/x-code-nowww/raw/master/image/linklist.png" width = "400" />
</div>    
      
 如上图所示，在 neo4j 中存储为单向关系，任意的关系都有一个 start node 和一个 end node，而且 start node 和 end node 都会有个关联的双向链表，这个双向链表中就记录了从该节点出去和进入的所有关系。  
<div align=center>
      <img src="https://github.com/OSH-2020/x-code-nowww/raw/master/image/property.png" width = "670" />
</div>      
      
##### 属性结构
1byte: 前后property id的高位信息  
8byte: 前后property  
32byte: 默认4个属性块（每个8byte）  
  
属性记录包括属性类型和指向属性索引文件的指针. 同时属性记录中可以内联和动态存储，在属性值存储占用小时，会直接存储在属性记录中，对于大属性值，可以分别存储在动态字符存储和动态数组存储中，由于动态记录同样由记录大小固定的记录链表组成，因此大字符串和大数组会占据多个动态记录。  


#### 算法
Neo4j自带多种搜索算法，功能强大，能够满足GDBFS的潜在需求。特别地，Neo4j自带一套易于学习的查询语言[Cypher](http://neo4j.com/docs/stable/cypher-query-lang.html)。    

###### 中心性算法（Centrality algorithms）
中心度算法主要用来判断一个图中不同节点的重要性

###### 社区发现算法（Community detection algorithms）
评估一个群体是如何聚集或划分的，以及其增强或分裂的趋势

###### 路径寻找算法（Path Finding algorithms）
用于找到最短路径，或者评估路径的可用性和质量

###### 相似度算法（Similarity algorithms）
用于计算节点间的相似度，包括jaccard算法、余弦相似度、欧几里得距离、pearson算法四种计算相似度的方式以及基于此为一组对象构造k最近邻图的近似最近邻（ANN）算法。

###### 链接预测算法（Link Prediction algorithms）
neo4j提供了多种以不同标准衡量节点之间紧密度的算法，我们将使用计算的分数作为链接预测解决方案的一部分。 


### 文件的自然属性
能够合理地描述文件的自然属性是GDBFS的基础，找到如何描述文件的方法是必不可少的，然而研究具体如何获取自然属性在定位上并不属于操作系统的范畴，不是我们的主要工作，在工作量上也太过繁重，我们预备采用互联网上公开提供使用的或开源的内容来帮助GDBFS完成文件自然属性的识别。因为网络上相关工作是针对不同文件类型进行处理的，我们也针对不同文件类型准备了如下备选方案

#### 文档

###### 讯飞开放平台
讯飞开放平台是一个开放的智能交互技术服务平台，开发者可以使用语音合成、语音识别、语音唤醒、语义理解、人脸识别等多项服务。在文档处理方面具体到提供了多种形式的文字识别，词法分析，依存句法分析，语义角色标注，语义依存分析，情感分析和关键词提取的功能。

###### ParallelDots
ParallelDots针对中文文档处理的功能尚有欠缺，但是对于英文文档处理功能相当全面，包括情感分析（Sentiment Analysis），情绪分析（Emotion Analysis），关键词提取，意图分析，潜在语义分析，文本分类，辱骂分容分类器（Abusive Content Classifier），讽刺检测（Sarcasm Detection）。

###### LinguaKit
LinguaKit包括情感分析，语言分析，关键词提取(一次性支持最多5000字)，词组提取，专用名词识别等

###### cortical.io
cortical.io作为一个付费平台，提供了一些免费服务，包括关键词提取，文档比较，歧义条款（Disambiguate Terms）

###### doc2vec
Doc2Vec 或者叫做 paragraph2vec, sentence embeddings，是一种非监督式算法，可以获得 sentences/paragraphs/documents 的向量表达，是 word2vec 的拓展。学出来的向量可以通过计算距离来找 sentences/paragraphs/documents 之间的相似性，可以用于文本聚类，对于有标签的数据，还可以用监督学习的方法进行文本分类，例如经典的情感分析问题。

#### 音频
对于音乐一类的音频，有很多公开平台做到了很好的识别正确率与识别速度，但是对于日常生活中的音频文件，自然属性的处理变得麻烦起来，我们预定对日常音频文件做声纹识别，语音转写并分析语义等多种方式综合处理

###### 讯飞开放平台
讯飞开放平台在语音识别方面具体到提供了语音听写，语音转写，声纹识别，性别年龄识别和歌曲识别的功能。

###### 音乐播放器的音乐识别
类似网易云音乐，QQ音乐等多款音乐播放器拥有音乐识别的功能

###### 翻译软件的语音转写
类似有道词典，谷歌翻译，微软翻译等翻译软件因为用户需求已经形成了强大的语音转写功能。

#### 图像与视频
对于图像，我们直接采用图像识别提取自然属性，对于视频文件，我们采取先提取关键帧再图像识别的方式，故将这两者方面一起介绍。

##### 图像

###### Clarifai
提供相似图片查找服务，能够识别图中多个要素，并按置信度排序，api可申请使用。  

###### Waston Recognition(IBM)
提供高度可定制平台，能够分析来自场景、物体、面部、颜色、食物、品牌及其他内容的图像，可以同时识别多个要素并按置信度排序，提供免费的api。  

###### Imagga
Imagga的图像识别工具提供了多种自动选项，用于根据类别，颜色，标签或自定义输入对图像进行分类，组织和显示。能够识别图中多个要素，并按置信度排序，提供免费的api。   

###### 百度识图
百度识图的成功率相比前面几个个能并不高，但是具有百度百科的天然优势，在识别成功后，会把相应的百度百科（如果有的话）展示出来

###### whatanime
whatanime拥有强大的影视作品识别能力，可以识别出图片具体出现在影视作品的第几季第几集（或者哪部电影），并给出相应的百科。  

##### 视频关键帧提取

###### FFmpeg
FFmpeg是一套可以用来记录、转换数字音频、视频，并能将其转化为流的开源计算机程序。采用LGPL或GPL许可证。它提供了录制、转换以及流化音视频的完整解决方案。它包含了非常先进的音频/视频编解码库libavcodec，为了保证高可移植性和编解码质量，libavcodec里很多code都是从头开发的。

FFmpeg在Linux平台下开发，但它同样也可以在其它操作系统环境中编译运行，包括Windows、Mac OS X等。这个项目最早由Fabrice Bellard发起，2004年至2015年间由Michael Niedermayer主要负责维护。许多FFmpeg的开发人员都来自MPlayer项目，而且当前FFmpeg也是放在MPlayer项目组的服务器上。项目的名称来自MPEG视频编码标准，前面的"FF"代表"Fast Forward"。

因为FFmpeg在关键帧提取方面非常优秀，我们并没有提供相应的关键帧提取的备选方案。

### 模糊搜索
在用户主动搜索文件的过程中，我们需要对用户的需求与现有自然属性匹配，这就用到了模糊匹配，我们准备了以下备选方案

#### word2vec
利用word2vec提取语义向量，在多维空间内寻找最近的一个（或多个）自然属性点来实现模糊搜索。  

#### Approximate String Matching
最常见的几种近似字符串搜索有:
1. Inserttion: co*t->co**a**t, cot->co**a**t
2. Deletion: co**a**t->co*t, co**a**t->cot
3. Substitution: co**a**t->co**s**t
4. Transposition: co**st**->co**ts**

#### FuzzyWuzzy-模糊字符串匹配工具
FuzzyWuzzy[FuzzyWuzzy Github](https://github.com/seatgeek/fuzzywuzzy) 是一个简单易用的模糊字符串匹配工具包。它主要支持Python语言，并能在Java，Rust，C++等常用高级语言上运行。
其主要原理是根据[Levenshtein Distance 算法 ](https://en.wikipedia.org/wiki/Levenshtein_distance)计算两个序列之间的差异。
> Levenshtein Distance 算法，又叫 Edit Distance 算法，是指两个字符串之间，由一个转成另一个所需的最少编辑操作次数。许可的编辑操作包括将一个字符替换成另一个字符，插入一个字符，删除一个字符。一般来说，编辑距离越小，两个串的相似度越大。
  
## 创新点

### 文件系统的智能化
智能生活概念势头正盛，涉及到智能家居、智能出行、智慧城市等一系列相关研究领域。智能这一概念出现在了生活的方方面面，然而对于文件系统本身，或者说操作系统的智能化却鲜有关注，GDBFS创新性地对操作系统的智能化展开了研究。

### 发掘利用文件的自然属性
GDBFS创新性地发掘利用文件的自然属性，为构建文件索引提供了一个不同于以往添加tag的新思路，通过文件的自然属性构建的索引也将具有优秀的稳定性以及泛用性。

### 图数据库与DBFS相结合
图天生关注对象和对象之间的关系，可以高效插入大量数据，查询关联数据，与以文件的自然属性为基础构建的GDBFS高度契合，但其应用范围并不广泛，主要应用于社交网络和推荐引擎。GDBFS创新地将图数据库与DBFS相结合，拓宽了图数据库的应用范围，推动了DBFS地发展。

### 高可扩展性
第三方可以自行添加关联算法与相似算法，用户可以选择使用的算法，使得GDBFS实际上可以构建基于不同逻辑的索引，也有利于GDBFS构建更加真实的自然属性索引。  

## 概要设计
初步的概要设计如下，视文件系统运行效率有可能做出更改

### 文件储存
文件经过自然属性提取后，以点的形式存储在图数据库中，记为文件点，自然属性也以点的形式储存在图数据库中，记为关键词点，文件点与其拥有的关键词点相连
注：在图数据库创建之初，我们将定义若干个关键词点，比如电影音乐图片等，并具有树状结构，新添加的关键词节点将成为这个树状结构的倒数第二层，倒数第一层为文件点

### 自然属性提取
利用公开的API接口借助互联网上的公开资源进行自然属性的提取，并记录有意义的部分识别为关键词节点

### 文件搜索
总体上，利用Neo4j强大的搜索算法进行文件搜索，不排除修改或自行编写新的搜索算法的可能

### 初步目标
完成图文件系统的可运行demo，并支持以下功能

- 拥有一般文件系统的基本功能
- 实现GDBFS特有的计算机智能化搜索文件的功能
- 在文档，图片，视频的自然属性提取方面至少提供一种效率准确率尚可的处理方式
- 能够对音乐进行识别

### 进阶目标
进阶目标是现阶段备选的更进一步工作，不一定能够出色完成，包括

- 拥有可视化的用户友好的客户端
- 实现对普通音频文件的自然属性提取
- 建立一套合理可行的评估方案数值化对比传统文件系统与GDBFS

## 参考文献
- [Neo4j-docs](https://neo4j.com/docs/)
- [http://dbfs.sourceforge.net/](http://dbfs.sourceforge.net/)  
- [GFS: a Graph-based File System Enhanced with Semantic Features](https://www.iit.cnr.it/sites/default/files/gfs.pdf)  
- [QMDS: A File System Metadata Management Service Supporting a Graph Data Model-based Query Language]()  
- [FuzzyWuzzy：简单易用的字符串模糊匹配工具](https://zhuanlan.zhihu.com/p/53135935)
